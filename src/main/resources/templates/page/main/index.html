<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Side Toon Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <link href="//cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css" rel='stylesheet' type='text/css'>
    <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0"></script>
    <script src="//cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
</head>
<body class="sb-nav-fixed">
<th:block th:replace="fragments/header :: headerFragment"></th:block>
<div id="layoutSidenav">
    <div id="layoutSidenav_nav">
        <th:block th:replace="fragments/sidebar :: sidebarFragment"></th:block>
    </div>
    <div id="layoutSidenav_content">
        <main>
            <div class="container-fluid px-4">
                <h1 class="mt-4">Dashboard</h1>
                <div class="row">
                    <div class="col-xl-3 col-md-6">
                        <div class="card mb-4">
                            <div style="text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                <canvas id="chart1"></canvas>
                                <p id="percentage"></p>
                            </div>
                            <div class="card-header">
                                <i class="fas fa-chart-pie me-1"></i>
                                안전수칙 준수율
                            </div>
                        </div>

                    </div>


                    <div class="col-xl-3 col-md-6">
                        <div class="card mb-4">
                            <div style="text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                <canvas id="chart2"></canvas>
                                <p id="noncom"></p>
                            </div>
                            <div class="card-header">
                                <i class="fas fa-chart-pie me-1"></i>
                                미준수 내역
                            </div>
                        </div>

                    </div>




                    <div class="col-xl-3 col-md-6">
                        <div class="card-body" style="border: 1px solid #D8D8D8; border-radius: 4px; background-color: #FFFFFF;">
                            <table class="table" id="datatablesSimple">
                                <thead>
                                <tr>
                                    <th scope="col">순위</th>
                                    <th scope="col">미준수 항목</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <th scope="row">1</th>
                                    <td>작업계획서 일치여부</td>
                                </tr>
                                <tr>
                                    <th scope="row">2</th>
                                    <td>주변 차량 통제</td>
                                </tr>
                                <tr>
                                    <th scope="row">3</th>
                                    <td>라바콘/안전표지판 설치</td>
                                </tr>
                                <tr>
                                    <th scope="row">4</th>
                                    <td>송/배풍기 가동 여부</td>
                                </tr>
                                <tr>
                                    <th scope="row">5</th>
                                    <td>철거 로프 사용 여부</td>
                                </tr>
                                <tr>
                                    <th scope="row">6</th>
                                    <td>안전시설물/신호수 배치</td>
                                </tr>
                                <tr>
                                    <th scope="row">7</th>
                                    <td>안전모 착용</td>
                                </tr>
                                <tr>
                                    <th scope="row">8</th>
                                    <td>통신주 신호수 배치 여부</td>
                                </tr>
                                <tr>
                                    <th scope="row">9</th>
                                    <td>감시인 배치 여부</td>
                                </tr>
                                <tr>
                                    <th scope="row">10</th>
                                    <td>철거 3인 1조 여부</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="card-header">
                            <i class="fas fa-table me-1"></i>
                            미준수 순위
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6">
                    </div>

                    <div class="col-xl-3 col-md-6">
                    </div>
                </div>

                <!-- 도넛 차트 script -->
                <script>
                    var data1 = {
                        datasets: [{
                            data: [1307, 41],
                            backgroundColor: ["#9DD6DA", "#DF7697"]
                        }]
                    };

                    var data2 = {
                        datasets: [{
                            data: [13, 8, 4, 4, 4, 8],
                            backgroundColor: ["#88F7A7", "#A7D474", "#EADF8D", "#D4B174", "#F5C9B8", "#DE9BAC"]
                        }]
                    };

                    // 도넛 차트1 생성 함수
                    function createDonutChart1(canvasId, data) {
                        var ctx = document.getElementById(canvasId).getContext('2d');
                        var chart = new Chart(ctx, {
                            type: 'doughnut',
                            data: data,
                            options: {
                                cutoutPercentage: 70, // 중앙에 구멍을 뚫기 위한 설정
                            }
                        });

                        // 백분율 출력
                        var percentage = '준수율\n' + (100 - (data.datasets[0].data[1] / data.datasets[0].data[0] * 100)).toFixed(2) + '%';
                        document.getElementById(canvasId).nextElementSibling.innerText = percentage;
                    }

                    // 도넛 차트2 생성 함수
                    function createDonutChart2(canvasId, data) {
                        var ctx = document.getElementById(canvasId).getContext('2d');
                        var chart = new Chart(ctx, {
                            type: 'doughnut',
                            data: data,
                            options: {
                                cutoutPercentage: 70, // 중앙에 구멍을 뚫기 위한 설정
                            }
                        });

                        // 백분율 출력
                        var percentage = '미준수\n' + data.datasets[0].data.reduce(function(acc, currentValue) { return acc + currentValue;}, 0).toFixed(0) + '건';
                        document.getElementById(canvasId).nextElementSibling.innerText = percentage;
                    }

                    // 도넛 차트 생성
                    createDonutChart1('chart1', data1)
                    createDonutChart2('chart2', data2)

                </script>

                <!-- 미준수 순위 script -->
                <script>
                </script>
            </div>
        </main>
        <th:block th:replace="fragments/footer :: footerFragment"></th:block>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="js/scripts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script src="assets/demo/chart-area-demo.js"></script>
<script src="assets/demo/chart-bar-demo.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" crossorigin="anonymous"></script> --> -->
<!-- <script src="js/datatables-simple-demo.js"></script> -->
<script
        src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
        crossorigin="anonymous"></script>

<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyBEZ0He9BbEXYyR5YP1z7KLAwboxOQHwOs",
        authDomain: "ai300-ssg.firebaseapp.com",
        projectId: "ai300-ssg",
        storageBucket: "ai300-ssg.appspot.com",
        messagingSenderId: "563079026653",
        appId: "1:563079026653:web:f15a888c3a9e8db5030834",
        measurementId: "G-W11R23KQN8"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

</script>
</body>
</html>